# Прогнозирование солнечной активности на основе радиоданных РАТАН-600

## Обзор проекта

Этот проект представляет собой исследование потенциала **наземных радиотелескопических наблюдений** для прогнозирования солнечных вспышек. В отличие от традиционных подходов, использующих данные космических обсерваторий (например, HMI/SHARP на спутнике SDO), мы исследуем возможность использования двухканальных сканов радиоизлучения с комплекса **РАТАН-600**.

Наше исследование демонстрирует, что радиоданные потенциально могут служить **эффективной и независимой альтернативой** для извлечения ключевых признаков, необходимых для прогнозирования. Проект реализует двухэтапный пайплайн:

1.  **Извлечение признаков**: С помощью свёрточного автоэнкодера (ConvAE), обученного на двухканальных радиосканах, мы сжимаем данные в информативные латентные представления (эмбеддинги).
2.  **Прогнозирование**: На основе этих эмбеддингов, а также на традиционных данных HMI/SHARP (в качестве контрольной группы), обучается модель логистической регрессии для прогнозирования солнечных вспышек.

-----

## Структура проекта

```
.
├── config/                 # YAML-файлы с конфигурацией для пайплайнов
│   ├── ae_config.yaml      # Настройки для пайплайна автоэнкодера
│   ├── logreg_config.yaml  # Настройки для пайплайна логистической регрессии
│   └── main_config.yaml    # Флаги для запуска пайплайнов
├── data/                   # Директории для хранения данных
│   ├── external/           # Данные из внешних источников (например, файлы синхронизации)
│   ├── processed/          # Обработанные данные (эмбеддинги, предсказания)
│   └── raw/                # Исходные необработанные данные (сканы РАТАН, данные SHARP)
├── LICENSE                 # Файл с лицензией MIT
├── log/                    # Лог-файлы выполнения скриптов
├── main.py                 # Главный исполняемый скрипт
├── notebooks/              # Jupyter-ноутбуки для экспериментов и анализа
│   └── SHARPvsRATAN_LogReg.ipynb
├── README.md               
├── reports/                # Отчёты и сгенерированные графики
├── requirements.txt        # Список зависимостей Python
└── src/                    # Исходный код проекта
    ├── config_models.py    # Модели Pydantic для валидации конфигурации
    ├── constants.py        # Константы и пути к директориям
    ├── dataset.py          # Класс PyTorch Dataset для загрузки данных
    ├── logger.py           # Настройка логгирования
    ├── models.py           # Определение архитектуры ConvAE
    ├── plot.py             # Функции для визуализации
    ├── scripts/            # Модульные шаги для пайплайнов
    │   ├── embeddings.py   # Шаги пайплайна автоэнкодера
    │   └── logreg.py       # Шаги пайплайна логистической регрессии
    └── utils.py            # Вспомогательные функции
```

-----

## Конфигурация проекта

Все параметры проекта, от путей к данным до гиперпараметров моделей, задаются в YAML-файлах в директории `config/`. Это позволяет легко воспроизводить эксперименты и настраивать проект.

  * `main_config.yaml`: Определяет, какие из двух основных пайплайнов (`ae` и `logreg`) будут запущены.
  * `ae_config.yaml`: Содержит все настройки для пайплайна автоэнкодера, включая параметры обучения, архитектуру модели и опции визуализации.
  * `logreg_config.yaml`: Содержит настройки для пайплайна логистической регрессии, включая список признаков, целевых переменных и параметры модели.

-----

## Запуск проекта

Для воспроизведения результатов следуйте этим шагам:

### 1\. Подготовка окружения

1.  **Клонируйте репозиторий**:

    ```bash
    git clone https://github.com/mezhbert/flare_radio_forecasting.git
    cd flare_radio_forecasting
    ```

2.  **Создайте и активируйте виртуальное окружение**:

    ```bash
    python -m venv venv
    source venv/bin/activate
    ```

3.  **Установите зависимости**:

    ```bash
    pip install -r requirements.txt
    ```

### 2\. Запуск пайплайнов

Главный исполняемый скрипт — `main.py`. Он запускает пайплайны на основе флагов, установленных в `config/main_config.yaml`.

```bash
python main.py
```

После выполнения все результаты, включая сохранённые модели, графики и таблицы предсказаний, будут доступны в директориях `models/`, `reports/` и `data/processed/`.

-----

## Лицензия

Этот проект распространяется под лицензией MIT. Подробности можно найти в файле `LICENSE`.
